diff -urNp setup-2.8.14-orig/bashrc setup-2.8.14/bashrc
--- setup-2.8.14-orig/bashrc	2011-06-30 15:14:46.079453614 +0200
+++ setup-2.8.14/bashrc	2011-06-30 15:18:22.593179752 +0200
@@ -10,6 +10,7 @@
 
 # are we an interactive shell?
 if [ "$PS1" ]; then
+  if [ -z "$PROMPT_COMMAND" ]; then
     case $TERM in
     xterm*)
         if [ -e /etc/sysconfig/bash-prompt-xterm ]; then
@@ -28,17 +29,18 @@ if [ "$PS1" ]; then
     *)
         [ -e /etc/sysconfig/bash-prompt-default ] && PROMPT_COMMAND=/etc/sysconfig/bash-prompt-default
         ;;
-    esac
-    # Turn on checkwinsize
-    shopt -s checkwinsize
-    [ "$PS1" = "\\s-\\v\\\$ " ] && PS1="[\u@\h \W]\\$ "
-    # You might want to have e.g. tty in prompt (e.g. more virtual machines)
-    # and console windows
-    # If you want to do so, just add e.g.
-    # if [ "$PS1" ]; then
-    #   PS1="[\u@\h:\l \W]\\$ "
-    # fi
-    # to your custom modification shell script in /etc/profile.d/ directory
+      esac
+  fi
+  # Turn on checkwinsize
+  shopt -s checkwinsize
+  [ "$PS1" = "\\s-\\v\\\$ " ] && PS1="[\u@\h \W]\\$ "
+  # You might want to have e.g. tty in prompt (e.g. more virtual machines)
+  # and console windows
+  # If you want to do so, just add e.g.
+  # if [ "$PS1" ]; then
+  #   PS1="[\u@\h:\l \W]\\$ "
+  # fi
+  # to your custom modification shell script in /etc/profile.d/ directory
 fi
 
 if ! shopt -q login_shell ; then # We're not a login shell
